package {	import flash.events.Event;	import flash.display.MovieClip;	public class Pipeline extends MovieClip	{		private var pipeline:Array;		private var failSound:FailSound;		private var currentItem:Item;		private var currentPart:Part;		public function Pipeline()		{			this.failSound = new FailSound();			this.pipeline = new Array();		}		public function addItems(items:Array)		{			this.pipeline = this.pipeline.concat(items);		}		private function getNextItem()		{			return this.pipeline.pop();		}		private function hasMoreItems()		{			return this.pipeline.length > 0;		}		public function process(event:Event)		{			if (this.currentItem == null)			{				this.currentItem = this.getNextItem();				this.currentPart = this.currentItem.parts.pop();				this.currentPart.addEventListener(Part.MISSED, this.miss);				addChild(this.currentPart);			}			this.currentPart.process();		}		private function miss(event:Event)		{			removeChild(this.currentPart);			this.failSound.play();			this.currentPart = this.currentItem.parts.pop();			this.currentPart.addEventListener(Part.MISSED, this.miss);			addChild(this.currentPart);		}	}}